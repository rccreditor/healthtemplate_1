<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Dashboard | Organic Wellness Hub</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* Minimal custom styles for dashboard-specific tweaks */
    .dashboard-welcome {
      background: var(--gradient-primary);
      color: var(--white) !important;
      border-radius: 24px;
      padding: 48px 36px 40px 36px;
      margin-bottom: 40px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }
    .dashboard-welcome h2 {
      font-size: 2.2rem;
      font-weight: 800;
      margin-bottom: 18px;
      letter-spacing: -1px;
      color: var(--white) !important;
    }
    .dashboard-welcome p {
      font-size: 1.15rem;
      font-weight: 500;
      opacity: 0.95;
      color: var(--white) !important;
    }
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 32px;
      margin-bottom: 40px;
    }
    .dashboard-card {
      background: var(--white);
      border-radius: 18px;
      box-shadow: var(--shadow);
      padding: 36px 28px 28px 28px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      transition: var(--transition);
      border: 1.5px solid var(--primary-light);
      position: relative;
    }
    .dashboard-card:hover {
      transform: translateY(-8px) scale(1.03);
      box-shadow: var(--shadow-hover);
      border-color: var(--primary-color);
    }
    .dashboard-card i {
      font-size: 2.2rem;
      color: var(--primary-color);
      margin-bottom: 1.2rem;
    }
    .dashboard-card h3 {
      color: var(--primary-dark);
      font-size: 1.2rem;
      margin-bottom: 12px;
      font-weight: 700;
    }
    .dashboard-card p {
      color: var(--text-light);
      font-size: 1.02rem;
      margin-bottom: 22px;
      flex: 1;
    }
    .dashboard-card .btn, .dashboard-card .btn:hover {
      color: var(--white) !important;
    }
    .activity-section {
      background: var(--light-color);
      border-radius: 18px;
      box-shadow: var(--shadow);
      padding: 32px 24px;
      margin-bottom: 40px;
    }
    .activity-section h3 {
      color: var(--primary-dark);
      font-size: 1.3rem;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
    }
    .activity-section h3 i {
      margin-right: 10px;
      color: var(--primary-color);
    }
    .activity-item {
      display: flex;
      align-items: center;
      padding: 1rem 0;
      border-bottom: 1px solid #e8f5e8;
    }
    .activity-item:last-child {
      border-bottom: none;
    }
    .activity-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: var(--primary-light);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 1rem;
      color: var(--white);
      font-size: 1.2rem;
    }
    .activity-content {
      flex: 1;
    }
    .activity-title {
      font-weight: 600;
      margin-bottom: 0.2rem;
      color: var(--primary-color);
    }
    .activity-date {
      font-size: 0.92rem;
      color: var(--text-light);
    }
    @media (max-width: 768px) {
      .dashboard-welcome {
        padding: 32px 12px 28px 12px;
      }
      .dashboard-grid {
        grid-template-columns: 1fr;
        gap: 18px;
      }
      .activity-section {
        padding: 18px 8px;
      }
    }
    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 2.5rem !important;
      color: var(--text-light);
      cursor: pointer;
      transition: color 0.3s;
      z-index: 10;
    }
    .modal-close:hover {
      color: var(--primary-color);
    }
  </style>
</head>
<body>
  <!-- Main site header -->
  <header class="header">
    <div class="container">
      <div class="logo">
        <span>Organic Wellness Hub</span>
      </div>
      <nav class="nav">
        <ul>
          <li><a href="index.html#home">Home</a></li>
          <li><a href="#" class="active">Dashboard</a></li>
          <li><a href="profile.html">Profile</a></li>
          <li><a href="payment.html">Payment</a></li>
          <li><a href="index.html#contact">Contact</a></li>
        </ul>
        <div class="mobile-menu-btn">
          <i class="fas fa-bars"></i>
        </div>
      </nav>
      <div class="auth-buttons" style="display:flex;align-items:center;gap:16px;">
        <a href="profile.html" class="user-avatar" id="userAvatar" style="width:60px;height:60px;border-radius:50%;overflow:hidden;cursor:pointer;border:2px solid var(--primary-color);background:#fff;display:flex;align-items:center;justify-content:center;">
          <img id="avatarImg" src="https://img.freepik.com/free-vector/smiling-young-man-illustration_1308-174669.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740" alt="User Avatar" style="width:100%;height:100%;object-fit:cover;">
        </a>
        <a href="#" class="btn btn-login" onclick="logout()">Logout</a>
      </div>
    </div>
  </header>
  <div class="container" style="padding-top:120px; padding-bottom:60px; min-height:80vh;">
    <div class="dashboard-welcome">
      <h2>Welcome back, <span id="username">Alex</span>! ðŸ‘‹</h2>
      <p>Here's a snapshot of your wellness journey. You're on day 12 of your health plan!</p>
    </div>
    <div class="dashboard-grid">
      <div class="dashboard-card">
        <i class="fas fa-heartbeat"></i>
        <h3>My Health Plan</h3>
        <p>View your personalized nutrition and lifestyle plan tailored to your wellness goals.</p>
        <a href="#" class="btn" onclick="showModal('plan')">View Plan <i class="fas fa-chevron-right"></i></a>
      </div>
      <div class="dashboard-card">
        <i class="fas fa-shopping-basket"></i>
        <h3>Order History</h3>
        <p>Review your past purchases of organic products and wellness supplements.</p>
        <a href="#" class="btn" onclick="showModal('order')">View Orders <i class="fas fa-chevron-right"></i></a>
      </div>
      <div class="dashboard-card">
        <i class="fas fa-calendar-check"></i>
        <h3>Book a Session</h3>
        <p>Schedule time with one of our certified health consultants.</p>
        <a href="#" class="btn" onclick="showModal('session')">Book Now <i class="fas fa-chevron-right"></i></a>
      </div>
      <div class="dashboard-card">
        <i class="fas fa-lightbulb"></i>
        <h3>Tips & Resources</h3>
        <p>Access exclusive wellness content curated specifically for you.</p>
        <a href="#" class="btn" onclick="showModal('tips')">Explore <i class="fas fa-chevron-right"></i></a>
      </div>
    </div>
    <div class="activity-section">
      <h3><i class="fas fa-bell"></i> Recent Activity</h3>
      <div class="activity-item">
        <div class="activity-icon">
          <i class="fas fa-check"></i>
        </div>
        <div class="activity-content">
          <div class="activity-title">Completed your daily wellness check-in</div>
          <div class="activity-date">Today, 9:30 AM</div>
        </div>
      </div>
      <div class="activity-item">
        <div class="activity-icon">
          <i class="fas fa-truck"></i>
        </div>
        <div class="activity-content">
          <div class="activity-title">Your organic tea order has shipped</div>
          <div class="activity-date">Yesterday, 2:15 PM</div>
        </div>
      </div>
      <div class="activity-item">
        <div class="activity-icon">
          <i class="fas fa-book-open"></i>
        </div>
        <div class="activity-content">
          <div class="activity-title">New article added: "Morning Routines for Energy"</div>
          <div class="activity-date">June 20, 2023</div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal Structure -->
  <div id="infoModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal()">&times;</span>
      <div class="modal-icon" id="modalIcon"></div>
      <h3 id="modalTitle">Notice</h3>
      <p id="modalMessage">You haven't enrolled in any plans yet.</p>
      <button class="btn" onclick="closeModal()">Got it!</button>
    </div>
  </div>
  <!-- Profile Settings Modal -->
  <div id="profileModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeProfileModal()">&times;</span>
      <div style="display:flex;flex-direction:column;align-items:center;">
        <div style="margin-bottom:18px;display:flex;flex-direction:column;align-items:center;">
          <img id="profilePicPreview" src="https://randomuser.me/api/portraits/men/32.jpg" alt="Profile Picture" style="width:120px;height:120px;border-radius:50%;object-fit:cover;border:3px solid var(--primary-color);margin-bottom:10px;">
          <div id="predefinedAvatars" style="display:flex;gap:12px;margin:15px 0 20px 0;flex-wrap:wrap;justify-content:center;max-width:400px;"></div>
          <div style="display:flex;gap:10px;">
            <label for="profilePicInput" class="btn" style="padding:8px 18px;font-size:1rem;cursor:pointer;">Change Photo</label>
            <input type="file" id="profilePicInput" accept="image/*" style="display:none;">
            <button class="btn btn-login" style="background:#fff;color:#d32f2f;border:1.5px solid #d32f2f;padding:8px 18px;font-size:1rem;" onclick="removeProfilePic()">Remove</button>
          </div>
        </div>
        <div style="width:100%;max-width:320px;display:flex;flex-direction:column;gap:16px;">
          <div>
            <label style="font-weight:600;color:var(--primary-color);">Username</label>
            <input type="text" id="profileUsername" style="width:100%;padding:10px 12px;border-radius:8px;border:1.5px solid var(--primary-light);font-size:1rem;">
          </div>
          <div>
            <label style="font-weight:600;color:var(--primary-color);">Email</label>
            <input type="email" id="profileEmail" style="width:100%;padding:10px 12px;border-radius:8px;border:1.5px solid var(--primary-light);font-size:1rem;">
          </div>
          <div>
            <label style="font-weight:600;color:var(--primary-color);">Phone</label>
            <input type="tel" id="profilePhone" style="width:100%;padding:10px 12px;border-radius:8px;border:1.5px solid var(--primary-light);font-size:1rem;">
          </div>
          <div>
            <label style="font-weight:600;color:var(--primary-color);">Password</label>
            <input type="password" id="profilePassword" style="width:100%;padding:10px 12px;border-radius:8px;border:1.5px solid var(--primary-light);font-size:1rem;">
          </div>
          <button class="btn" style="width:100%;margin-top:10px;" onclick="saveProfile()">Save Changes</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Main site footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-about">
          <div class="logo">
            <span>Organic Wellness Hub</span>
          </div>
          <p>Empowering individuals to achieve optimal health through organic nutrition and sustainable lifestyle practices.</p>
        </div>
        <div class="footer-links">
          <h4>Quick Links</h4>
          <ul>
            <li><a href="privacy.html">Privacy Policy</a></li>
            <li><a href="#">Return & Refund</a></li>
            <li><a href="#">Terms and Condition</a></li>
          </ul>
        </div>
        <div class="footer-contact">
          <h4>Contact Information</h4>
          <div class="info-item">
            <i class="fas fa-map-marker-alt"></i>
            <p>123 Wellness Way, Health City, HC 12345</p>
          </div>
          <div class="info-item">
            <i class="fas fa-phone"></i>
            <p>(800) 555-HEAL</p>
          </div>
          <div class="info-item">
            <i class="fas fa-envelope"></i>
            <p>info@organicwellnesshub.com</p>
          </div>
          <div class="info-item">
            <i class="fas fa-clock"></i>
            <p>Monday-Friday: 9am-6pm<br>Saturday: 10am-4pm</p>
          </div>
          <div class="social-links">
            <a href="#"><i class="fab fa-facebook-f"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-youtube"></i></a>
          </div>
        </div>
        <div class="footer-newsletter">
          <h4>Health Tips Newsletter</h4>
          <p>Subscribe to receive monthly health tips and special offers.</p>
          <form id="newsletterForm">
            <input type="email" placeholder="Your Email" required>
            <button type="submit">Subscribe</button>
          </form>
        </div>
      </div>
      <div class="footer-bottom">
        <p class="footer-copyright">&copy; 2023 Organic Wellness Hub. All rights reserved.</p>
        <div class="legal-links">
          <a href="privacy.html">Privacy Policy</a>
          <a href="termsandservices.html">Terms of Service</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="script.js"></script>
  <script>
    // Enhanced user handling with sample data
    document.addEventListener('DOMContentLoaded', function() {
      // Check if user is logged in (simulated)
      const loggedInUser = localStorage.getItem('loggedInUser');
      if (!loggedInUser) {
        // Redirect to login if not authenticated
        window.location.href = 'login.html';
      } else {
        // Display user data
        const user = JSON.parse(loggedInUser);
        document.getElementById('username').textContent = user.name || 'User';
      }
      updateCartCount();
    });
    function logout() {
      localStorage.removeItem('loggedInUser');
      window.location.href = "login.html";
    }
    // Modal functions
    function showModal(type) {
      event.preventDefault();
      const modal = document.getElementById('infoModal');
      const modalIcon = document.getElementById('modalIcon');
      const modalTitle = document.getElementById('modalTitle');
      const modalMessage = document.getElementById('modalMessage');
      switch(type) {
        case 'plan':
          modalIcon.className = 'modal-icon fas fa-heartbeat';
          modalTitle.textContent = 'My Health Plan';
          modalMessage.innerHTML = 'Calories today: <b>1,850</b><br>Protein: <b>90g</b><br>Next meal: <b>Quinoa Salad at 1:00 PM</b>';
          break;
        case 'order':
          modalIcon.className = 'modal-icon fas fa-shopping-basket';
          modalTitle.textContent = 'Order History';
          modalMessage.innerHTML = 'Last order: <b>Organic Green Tea</b> ($12.99)<br>Delivered: <b>2 days ago</b><br>Pending: <b>Chia Seeds</b>';
          break;
        case 'session':
          modalIcon.className = 'modal-icon fas fa-calendar-check';
          modalTitle.textContent = 'Book a Session';
          modalMessage.innerHTML = 'Next session: <b>June 28, 2024</b> at <b>3:00 PM</b><br>Consultant: <b>Dr. Smith</b>';
          break;
        case 'tips':
          modalIcon.className = 'modal-icon fas fa-lightbulb';
          modalTitle.textContent = 'Tips & Resources';
          modalMessage.innerHTML = 'New: <b>"5 Ways to Boost Your Energy"</b><br>Popular: <b>"Plant-Based Protein Guide"</b>';
          break;
      }
      modal.style.display = 'flex';
    }
    function closeModal() {
      document.getElementById('infoModal').style.display = 'none';
    }
    // Close modal when clicking outside of it
    window.onclick = function(event) {
      const modal = document.getElementById('infoModal');
      if (event.target == modal) {
        closeModal();
      }
    }
    // Function to handle going to payment page
    function goToPayment() {
      window.location.href = "payment.html";
    }
    // Optional: Function to update cart count
    function updateCartCount() {
      const cartCount = localStorage.getItem('cartCount') || 0;
      const cartCountElem = document.querySelector('.cart-count');
      if(cartCountElem) cartCountElem.textContent = cartCount;
    }
    const predefinedAvatarsList = [
      'https://img.freepik.com/free-vector/smiling-young-man-illustration_1308-174669.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/free-vector/young-prince-royal-attire_1308-176144.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/free-vector/woman-floral-traditional-costume_1308-176159.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/free-vector/woman-with-braided-hair-illustration_1308-174675.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/free-vector/smiling-woman-with-braided-hair_1308-175716.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/premium-vector/portrait-young-man-full-face_276162-177.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/premium-vector/portrait-smiling-man-with-beard-blue-circle_1139689-16030.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/free-photo/portrait-man-cartoon-style_23-2151133862.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/free-photo/portrait-man-cartoon-style_23-2151133876.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/premium-vector/lively-cartoon-figure-with-distinct-round-eyes-trendy-hairstyle-dressed-colorful-outfit-photo-customizable-cartoon-illustration_538213-146625.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/free-photo/3d-cartoon-style-character_23-2151034122.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/free-photo/young-man-cartoon-character-with-phone_23-2150964365.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/premium-vector/flat-style-vector-game-developer-character-illustration_1033579-65336.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/premium-vector/vector-man-illustration-man_1274338-50.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/free-photo/portrait-man-christmas-celebrations_23-2150936475.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740',
      'https://img.freepik.com/premium-vector/actor-vector-character-illustration-flat-style_1033579-65302.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740'
    ];
    function renderPredefinedAvatars() {
      const container = document.getElementById('predefinedAvatars');
      container.innerHTML = '';
      predefinedAvatarsList.forEach(url => {
        const img = document.createElement('img');
        img.src = url;
        img.alt = 'Avatar';
        img.style.width = '80px';
        img.style.height = '80px';
        img.style.borderRadius = '50%';
        img.style.objectFit = 'cover';
        img.style.border = '2px solid #ccc';
        img.style.cursor = 'pointer';
        img.style.transition = 'transform 0.2s, border-color 0.2s';
        img.onmouseover = function() {
          this.style.transform = 'scale(1.1)';
          this.style.borderColor = 'var(--primary-color)';
        };
        img.onmouseout = function() {
          this.style.transform = 'scale(1)';
          this.style.borderColor = '#ccc';
        };
        img.onclick = function() {
          document.getElementById('profilePicPreview').src = url;
          // Update all borders to indicate selection
          container.querySelectorAll('img').forEach(img => img.style.borderColor = '#ccc');
          this.style.borderColor = 'var(--primary-color)';
        };
        container.appendChild(img);
      });
    }
    document.getElementById('userAvatar').onclick = function() {
      document.getElementById('profileModal').style.display = 'flex';
      // Set current avatar and user info
      document.getElementById('profilePicPreview').src = document.getElementById('avatarImg').src;
      document.getElementById('profileUsername').value = document.getElementById('username').textContent;
      document.getElementById('profileEmail').value = 'user@email.com'; // Demo value
      document.getElementById('profilePhone').value = '+1234567890'; // Demo value
      document.getElementById('profilePassword').value = '';
      renderPredefinedAvatars();
    };
    document.getElementById('profilePicInput').onchange = function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(evt) {
          document.getElementById('profilePicPreview').src = evt.target.result;
        };
        reader.readAsDataURL(file);
      }
    };
    function removeProfilePic() {
      document.getElementById('profilePicPreview').src = 'https://img.freepik.com/free-vector/smiling-young-man-illustration_1308-174669.jpg?uid=R156222685&ga=GA1.1.1994287649.1749448788&semt=ais_items_boosted&w=740';
    }
    function saveProfile() {
      // Gather updated info
      const name = document.getElementById('profileUsername').value;
      const email = document.getElementById('profileEmail').value;
      const phone = document.getElementById('profilePhone').value;
      const password = document.getElementById('profilePassword').value;
      const avatar = document.getElementById('profilePicPreview').src;

      fetch('http://localhost:3000/api/auth/profile', {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, email, phone, password, avatar })
      })
        .then(res => res.json())
        .then(data => {
          if (data.message === 'Profile updated successfully') {
            document.getElementById('username').textContent = name;
            document.getElementById('avatarImg').src = avatar;
            closeProfileModal();
            alert('Profile updated!');
          } else {
            alert(data.message || data.error || 'Update failed.');
          }
        })
        .catch(err => {
          alert('Error: ' + err.message);
        });
    }
    function closeProfileModal() {
      document.getElementById('profileModal').style.display = 'none';
    }
    function forgotPassword() {
      alert('Password reset instructions have been sent to your email (demo).');
    }
  </script>
</body>
</html>